% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mediation_estimation.R
\name{r2_estimation_cf}
\alias{r2_estimation_cf}
\title{Cross-Fitted R²-Based Mediation Effect Estimation}
\usage{
r2_estimation_cf(X, M, Y, K, covariates = NULL, nfold = 2, seed = 123)
}
\arguments{
\item{X}{Numeric vector. Exposure variable.}

\item{M}{Numeric matrix. Mediators (rows = samples, columns = mediators).}

\item{Y}{Numeric vector. Binary outcome variable (0/1).}

\item{K}{Numeric. Proportion of cases in the population.}

\item{covariates}{Numeric matrix. Covariates included in the model.}

\item{nfold}{Integer. Number of cross-fitting folds. Default is 2.}

\item{seed}{Integer. Random seed for reproducibility. Default is 123.}
}
\value{
A named list containing:
\describe{
  \item{Rmed.est}{Estimated mediation effect.}
  \item{Q.est}{Estimated Q measure.}
  \item{varl.est}{Total variance estimate.}
  \item{sig2_11.est}{Estimated variance component for indirect effects.}
  \item{sig2_a.est}{Estimated variance component for exposure effects.}
  \item{gamma.est}{Estimated direct effect of exposure on outcome.}
  \item{sig_number}{Number of selected significant mediators.}
  \item{time}{Total computation time in seconds.}
}
}
\description{
This function estimates the mediation effect (R² measure) using cross-fitting.
It performs mediator selection, variance estimation, and mediation effect estimation in
high-dimensional mediation analysis.
}
\examples{
data <- data_generate(p = 1000, N = 100, K = 0.05, r = 0.2, res.var = 0.5,
                      pi_11 = 0.09, pi_alpha = 0.3, pi_beta = 0.3,
                      sig2_a = 0.5, sig2_11 = 0.2, sig2_01 = 0.3, seed = 123)
result <- r2_estimation_cf(data$x, data$M, data$y, K = 0.05)
print(result)

}
